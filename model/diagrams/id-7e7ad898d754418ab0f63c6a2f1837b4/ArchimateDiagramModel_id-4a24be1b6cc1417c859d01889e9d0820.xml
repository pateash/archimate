<archimate:ArchimateDiagramModel
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:archimate="http://www.archimatetool.com/archimate"
    name="Skyscanner_IV2"
    id="id-4a24be1b6cc1417c859d01889e9d0820">
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-ff4036fdb12c4d68a3d9304ec576126b"
      targetConnections="id-f25b0f8173bf412e85ac5bd7aa301c68">
    <bounds
        x="48"
        y="108"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:BusinessActor"
        href="BusinessActor_id-aeeb2b2315154529b0e57474d9b0ca30.xml#id-aeeb2b2315154529b0e57474d9b0ca30"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-d0db57f3692647a593546d51cc0ab5c5"
      targetConnections="id-773ef9f9f50340adbbb13a462985c50c">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-f25b0f8173bf412e85ac5bd7aa301c68"
        source="id-d0db57f3692647a593546d51cc0ab5c5"
        target="id-ff4036fdb12c4d68a3d9304ec576126b">
      <archimateRelationship
          xsi:type="archimate:ServingRelationship"
          href="ServingRelationship_id-485f08f6dc3c41ca98b7c95e0fb65ae8.xml#id-485f08f6dc3c41ca98b7c95e0fb65ae8"/>
    </sourceConnections>
    <bounds
        x="228"
        y="108"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:ApplicationService"
        href="ApplicationService_id-d85f4fef732741e9a1138a568d667bcf.xml#id-d85f4fef732741e9a1138a568d667bcf"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-d229acb451f845eea9ec0e4e98359bbf">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-773ef9f9f50340adbbb13a462985c50c"
        source="id-d229acb451f845eea9ec0e4e98359bbf"
        target="id-d0db57f3692647a593546d51cc0ab5c5">
      <archimateRelationship
          xsi:type="archimate:ServingRelationship"
          href="ServingRelationship_id-ff22399d5d6e4ff1885f8ae69fdfa7f1.xml#id-ff22399d5d6e4ff1885f8ae69fdfa7f1"/>
    </sourceConnections>
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-599a8dcee15740cea6bf9e0aae2f625c"
        source="id-d229acb451f845eea9ec0e4e98359bbf"
        target="id-cc7300b930f2412d87d47e183184e8cb">
      <archimateRelationship
          xsi:type="archimate:AccessRelationship"
          href="AccessRelationship_id-a98251b001ae484086acfc733f5e5800.xml#id-a98251b001ae484086acfc733f5e5800"/>
    </sourceConnections>
    <bounds
        x="456"
        y="51"
        width="120"
        height="241"/>
    <archimateElement
        xsi:type="archimate:CommunicationNetwork"
        href="CommunicationNetwork_id-351170a20bff46e4a870c2c88ea84567.xml#id-351170a20bff46e4a870c2c88ea84567"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-cc7300b930f2412d87d47e183184e8cb"
      targetConnections="id-599a8dcee15740cea6bf9e0aae2f625c id-28734fdcab814d8690fdab42b3915d67 id-adad349237e0466c828206d3d15ebf49 id-f307ea1e033140a3bf1292412e019c1f">
    <bounds
        x="672"
        y="132"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:DataObject"
        href="DataObject_id-30ffc4aa3e53474ba5525c827cb7a176.xml#id-30ffc4aa3e53474ba5525c827cb7a176"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelNote"
      id="id-5c228335538f43719ffdea74643242b0"
      textAlignment="1"
      content="Redshift / BQ/ S3/ GCS&#xA;">
    <bounds
        x="672"
        y="72"
        width="145"
        height="37"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-bf0d2160d3a449a696eeef2d162e9a45"
      targetConnections="id-9bdffb1412d54ce9bde8d9cbbe60da22">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-a0661503644a4f94890ee036b49535a0"
        source="id-bf0d2160d3a449a696eeef2d162e9a45"
        target="id-a65e097e4fa848cab9e9a483cc18f30d">
      <archimateRelationship
          xsi:type="archimate:AggregationRelationship"
          href="AggregationRelationship_id-273ff7b142ae465989d734f655534243.xml#id-273ff7b142ae465989d734f655534243"/>
    </sourceConnections>
    <bounds
        x="1056"
        y="144"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:ApplicationService"
        href="ApplicationService_id-e8f6514015744d8fa07f95dd5c47776e.xml#id-e8f6514015744d8fa07f95dd5c47776e"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-bb8236139b3b4418a6e8f886c7a203f0">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-9bdffb1412d54ce9bde8d9cbbe60da22"
        source="id-bb8236139b3b4418a6e8f886c7a203f0"
        target="id-bf0d2160d3a449a696eeef2d162e9a45">
      <archimateRelationship
          xsi:type="archimate:ServingRelationship"
          href="ServingRelationship_id-569d00b0e2454bde8a1bf489a4d46f50.xml#id-569d00b0e2454bde8a1bf489a4d46f50"/>
    </sourceConnections>
    <bounds
        x="1056"
        y="324"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:BusinessActor"
        href="BusinessActor_id-85bb7397588c4b19aba81d580937a0e5.xml#id-85bb7397588c4b19aba81d580937a0e5"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-37366e6ed6be44d4a0b8bfe64580799c">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-28734fdcab814d8690fdab42b3915d67"
        source="id-37366e6ed6be44d4a0b8bfe64580799c"
        target="id-cc7300b930f2412d87d47e183184e8cb">
      <archimateRelationship
          xsi:type="archimate:AssociationRelationship"
          href="AssociationRelationship_id-57844fcd9e9a47cea51343c1994aa3e7.xml#id-57844fcd9e9a47cea51343c1994aa3e7"/>
    </sourceConnections>
    <bounds
        x="672"
        y="324"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:ApplicationService"
        href="ApplicationService_id-c585084838a947d9b1d652c1728e1472.xml#id-c585084838a947d9b1d652c1728e1472"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-a65e097e4fa848cab9e9a483cc18f30d"
      targetConnections="id-a0661503644a4f94890ee036b49535a0">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-adad349237e0466c828206d3d15ebf49"
        source="id-a65e097e4fa848cab9e9a483cc18f30d"
        target="id-cc7300b930f2412d87d47e183184e8cb">
      <archimateRelationship
          xsi:type="archimate:AccessRelationship"
          href="AccessRelationship_id-378abd58560b4dbb8283ab0da9874729.xml#id-378abd58560b4dbb8283ab0da9874729"/>
    </sourceConnections>
    <bounds
        x="852"
        y="144"
        width="120"
        height="55"/>
    <archimateElement
        xsi:type="archimate:ApplicationService"
        href="ApplicationService_id-cd64e30020484c38a855e8a89d04faa0.xml#id-cd64e30020484c38a855e8a89d04faa0"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelNote"
      id="id-53644ffd3c8c43df9573491ac00feaa7"
      textAlignment="1"
      content="EMR/DATAPROC/GLUE&#xA;">
    <bounds
        x="666"
        y="408"
        width="157"
        height="48"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelNote"
      id="id-6d5e3561327d4136b951fe62f81e6e64"
      textAlignment="1"
      content="//path - warehouse_location/table_name/partitions_date/&lt;DATA>&#xA;&#xA;&#xA;val df = spark.read.avro(Path)&#xA;val users = spark.read.avro(userpath)&#xA;&#xA;val agg_df = df.groupBy(&quot;user_id&quot;)&#xA;.agg(&#xA;&#x9;count(&quot;*&quot;).as(&quot;search_counts&quot;)&#xA;).select(&quot;user_id&quot;,&quot;search_counts&quot;)&#xA;&#xA;val final_df = users.as(&quot;seaches&quot;).join(agg_df.as(&quot;counts&quot;), col(&quot;user_id&quot;), &quot;left_outer&quot;)&#xA;.select(&quot;searches.*&quot;, &quot;search_counts&quot;)&#xA;&#xA;&#xA;final_df.write(bq).partitionBy(&quot;parition_date&quot;).table(&quot;table_name&quot;)&#xA;">
    <bounds
        x="564"
        y="468"
        width="505"
        height="192"/>
  </children>
  <children
      xsi:type="archimate:DiagramModelArchimateObject"
      id="id-c607025cb4bb4db1b730d5a49976066f">
    <sourceConnections
        xsi:type="archimate:DiagramModelArchimateConnection"
        id="id-f307ea1e033140a3bf1292412e019c1f"
        source="id-c607025cb4bb4db1b730d5a49976066f"
        target="id-cc7300b930f2412d87d47e183184e8cb">
      <archimateRelationship
          xsi:type="archimate:AccessRelationship"
          href="AccessRelationship_id-3512c79b8fc94fa29682e8cca66f9781.xml#id-3512c79b8fc94fa29682e8cca66f9781"/>
    </sourceConnections>
    <bounds
        x="852"
        y="24"
        width="132"
        height="60"/>
    <archimateElement
        xsi:type="archimate:ApplicationService"
        href="ApplicationService_id-88097a63c1c44d0db4da961a061217e7.xml#id-88097a63c1c44d0db4da961a061217e7"/>
  </children>
</archimate:ArchimateDiagramModel>
